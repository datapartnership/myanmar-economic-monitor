mean()
r_after <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_05|2023_06|2023_07|2023_08|2023_09|2023_10|2023_11|2023_12") %>%
rast() %>%
mean()
make_table <- function(roi_sf, unit_name){
roi_sf$ntl_before <- exact_extract(r_before,     roi_sf, "sum", progress = F)
roi_sf$ntl_after  <- exact_extract(r_after, roi_sf, "sum", progress = F)
roi_sf <- roi_sf %>%
dplyr::mutate(pc = (ntl_after - ntl_before) / ntl_before * 100) %>%
st_drop_geometry() %>%
dplyr::filter(ntl_before > 0)
roi_sf$Name <- roi_sf[[unit_name]]
roi_sf %>%
dplyr::select(Name, r_before, r_after, pc) %>%
dplyr::mutate(across(c(ntl_2022, contains("pc_")), ~ round(.x, 2))) %>%
dplyr::rename("NTL: Jan - Mar" = r_before,
"NTL: April - Dec" = r_after,
"% Change"= pc) %>%
DT::datatable()
}
roi_sf <- load_gadm(0)
make_table(roi_sf, "COUNTRY")
make_table <- function(roi_sf, unit_name){
roi_sf$ntl_before <- exact_extract(r_before,     roi_sf, "sum", progress = F)
roi_sf$ntl_after  <- exact_extract(r_after, roi_sf, "sum", progress = F)
roi_sf <- roi_sf %>%
dplyr::mutate(pc = (ntl_after - ntl_before) / ntl_before * 100) %>%
st_drop_geometry() %>%
dplyr::filter(ntl_before > 0)
roi_sf$Name <- roi_sf[[unit_name]]
roi_sf %>%
dplyr::select(Name, ntl_before, ntl_after, pc) %>%
dplyr::mutate(across(c(ntl_before, ntl_after, pc), ~ round(.x, 2))) %>%
dplyr::rename("NTL: Jan - Mar" = ntl_before,
"NTL: April - Dec" = ntl_after,
"% Change"= pc) %>%
DT::datatable()
}
roi_sf <- load_gadm(0)
make_table(roi_sf, "COUNTRY")
ntl_df <- readRDS(file.path(ntl_bm_dir, "aggregated",
paste0("ntl_", "adm2", "_", "monthly", ".Rds")))
nrow(ntl_df)
ntl_df$NAME_2
ntl_df$NAME_2 %>% unique()
ntl_df <- readRDS(file.path(ntl_bm_dir, "aggregated",
paste0("ntl_", "adm2", "_", "monthly", ".Rds")))
ntl_df %>%
dplyr::mutate(date = date %>% ymd()) %>%
dplyr::filter(date >= ymd("2020-01-01")) %>%
ggplot() +
geom_vline(xintercept = ymd("2023-04-01"), color = "red") +
geom_col(aes(x = date, y = ntl_sum),
fill = wbg_color_light) +
facet_wrap(~NAME_2) +
labs(x = NULL,
y = "Nighttime Lights") +
theme_manual
#| fig-height: 12
ntl_df <- readRDS(file.path(ntl_bm_dir, "aggregated",
paste0("ntl_", "adm2", "_", "annual", ".Rds")))
ntl_df %>%
dplyr::select(date, NAME_2, ntl_gf_10km_sum, ntl_nogf_10km_sum) %>%
pivot_longer(cols = -c(date, NAME_2)) %>%
dplyr::mutate(name = case_when(
name == "ntl_gf_10km_sum" ~ "NTL: Gas Flares",
name == "ntl_nogf_10km_sum" ~ "NTL: No Gas Flares"
)) %>%
#filter(NAME_2 %in% top_adm) %>%
ggplot() +
geom_line(aes(x = date,
y = value,
color = name),
linewidth = 1) +
labs(color = NULL,
x = NULL,
y = "NTL") +
facet_wrap(~NAME_2
scales = "free_y",
#| fig-height: 12
ntl_df <- readRDS(file.path(ntl_bm_dir, "aggregated",
paste0("ntl_", "adm2", "_", "annual", ".Rds")))
top_adm <- ntl_df %>%
filter(date == 2023) %>%
arrange(-ntl_sum) %>%
pull(NAME_2) %>%
head(12)
ntl_df %>%
#filter(NAME_2 %in% top_adm) %>%
ggplot() +
geom_col(aes(x = date, y = ntl_sum),
fill = wbg_color_light) +
facet_wrap(~NAME_2,
scales = "free_y",
ncol = 4) +
labs(x = NULL,
y = "Nighttime Lights") +
theme_manual
#| fig-height: 24
ntl_df <- readRDS(file.path(ntl_bm_dir, "aggregated",
paste0("ntl_", "adm2", "_", "annual", ".Rds")))
top_adm <- ntl_df %>%
filter(date == 2023) %>%
arrange(-ntl_sum) %>%
pull(NAME_2) %>%
head(12)
ntl_df %>%
#filter(NAME_2 %in% top_adm) %>%
ggplot() +
geom_col(aes(x = date, y = ntl_sum),
fill = wbg_color_light) +
facet_wrap(~NAME_2,
scales = "free_y",
ncol = 4) +
labs(x = NULL,
y = "Nighttime Lights") +
theme_manual
#| fig-height: 40
ntl_df <- readRDS(file.path(ntl_bm_dir, "aggregated",
paste0("ntl_", "adm2", "_", "annual", ".Rds")))
top_adm <- ntl_df %>%
filter(date == 2023) %>%
arrange(-ntl_sum) %>%
pull(NAME_2) %>%
head(12)
ntl_df %>%
#filter(NAME_2 %in% top_adm) %>%
ggplot() +
geom_col(aes(x = date, y = ntl_sum),
fill = wbg_color_light) +
facet_wrap(~NAME_2,
scales = "free_y",
ncol = 4) +
labs(x = NULL,
y = "Nighttime Lights") +
theme_manual
r_before <- file.path(ntl_bm_dir, "rasters", "annual") %>%
list.files(full.names = T) %>%
str_subset("2022") %>%
rast()
r_2023_04_06 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_04|2023_05|2023_06") %>%
rast() %>%
mean()
r_before
r_2023_04_06
file.path(ntl_bm_dir, "rasters", "annual") %>%
list.files(full.names = T) %>%
str_subset("2022")
roi_sf <- load_gadm(1)
#### Prep Rasters
r_before <- file.path(ntl_bm_dir, "rasters", "annual") %>%
list.files(full.names = T) %>%
str_subset("2022") %>%
rast()
r_2023_04_06 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_04|2023_05|2023_06") %>%
rast() %>%
mean()
r_2023_04_06 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_04|2023_05|2023_06") %>%
rast() %>%
mean()
r_2023_07_09 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_07|2023_08|2023_09") %>%
rast() %>%
mean()
r_2023_10_12 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_10|2023_11|2023_12") %>%
rast() %>%
mean()
r_2023_10_12 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_10|2023_11|2023_12") %>%
rast() %>%
mean()
r_2024_01_03 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_01|2023_02|2023_03") %>%
rast() %>%
mean()
r_2024_01_03 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_01|2023_02|2023_03") %>%
rast() %>%
mean()
r_2024_04_06 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_04|2023_05|2023_06") %>%
rast() %>%
mean()
make_table <- function(roi_sf, unit_name){
roi_sf$ntl_2022       <- exact_extract(r_before,     roi_sf, "sum", progress = F)
roi_sf$ntl_2023_04_06 <- exact_extract(r_2023_04_06, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_07_09 <- exact_extract(r_2023_07_09, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_10_12 <- exact_extract(r_2023_10_12, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_01_03 <- exact_extract(r_2024_01_03, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_04_06 <- exact_extract(r_2024_04_06, roi_sf, "sum", progress = F)
roi_sf <- roi_sf %>%
dplyr::mutate(pc_2023_04_06 = (ntl_2023_04_06 - ntl_2022) / ntl_2022 * 100,
pc_2023_07_09 = (ntl_2023_07_09 - ntl_2022) / ntl_2022 * 100,
pc_2023_10_12 = (ntl_2023_10_12 - ntl_2022) / ntl_2022 * 100,
pc_2024_01_03 = (ntl_2024_01_03 - ntl_2022) / ntl_2022 * 100,
pc_2024_04_06 = (ntl_2024_04_06 - ntl_2022) / ntl_2022 * 100) %>%
st_drop_geometry() %>%
dplyr::filter(ntl_2022 > 0)
roi_sf$Name <- roi_sf[[unit_name]]
roi_sf %>%
dplyr::select(Name, ntl_2022, contains("pc_")) %>%
dplyr::mutate(across(c(ntl_2022, contains("pc_")), ~ round(.x, 2))) %>%
dplyr::rename("NTL: 2022" = ntl_2022,
"% Change: 2023 Q2"= pc_2023_04_06,
"% Change: 2023 Q3"= pc_2023_07_09,
"% Change: 2023 Q4"= pc_2023_10_12,
"% Change: 2024 Q1"= pc_2024_01_03,
"% Change: 2024 Q2"= pc_2024_04_06) %>%
DT::datatable()
}
unit_name= "adm"
roi_sf$ntl_2022       <- exact_extract(r_before,     roi_sf, "sum", progress = F)
roi_sf$ntl_2022       <- exact_extract(r_before,     roi_sf, "sum", progress = F)
roi_sf$ntl_2023_04_06 <- exact_extract(r_2023_04_06, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_04_06 <- exact_extract(r_2023_04_06, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_07_09 <- exact_extract(r_2023_07_09, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_10_12 <- exact_extract(r_2023_10_12, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_01_03 <- exact_extract(r_2024_01_03, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_01_03 <- exact_extract(r_2024_01_03, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_04_06 <- exact_extract(r_2024_04_06, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_04_06 <- exact_extract(r_2024_04_06, roi_sf, "sum", progress = F)
roi_sf <- roi_sf %>%
dplyr::mutate(pc_2023_04_06 = (ntl_2023_04_06 - ntl_2022) / ntl_2022 * 100,
pc_2023_07_09 = (ntl_2023_07_09 - ntl_2022) / ntl_2022 * 100,
pc_2023_10_12 = (ntl_2023_10_12 - ntl_2022) / ntl_2022 * 100,
pc_2024_01_03 = (ntl_2024_01_03 - ntl_2022) / ntl_2022 * 100,
pc_2024_04_06 = (ntl_2024_04_06 - ntl_2022) / ntl_2022 * 100) %>%
st_drop_geometry() %>%
dplyr::filter(ntl_2022 > 0)
roi_sf$ntl_2024_01_03 <- exact_extract(r_2024_01_03, roi_sf, "sum", progress = F)
#### Prep Rasters
r_before <- file.path(ntl_bm_dir, "rasters", "annual") %>%
list.files(full.names = T) %>%
str_subset("2022") %>%
rast()
r_2023_04_06 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_04|2023_05|2023_06") %>%
rast() %>%
mean()
r_2023_04_06 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_04|2023_05|2023_06") %>%
rast() %>%
mean()
r_2023_07_09 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_07|2023_08|2023_09") %>%
rast() %>%
mean()
r_2023_10_12 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_10|2023_11|2023_12") %>%
rast() %>%
mean()
r_2023_10_12 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_10|2023_11|2023_12") %>%
rast() %>%
mean()
r_2024_01_03 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_01|2023_02|2023_03") %>%
rast() %>%
mean()
r_2024_04_06 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_04|2023_05|2023_06") %>%
rast() %>%
mean()
r_2024_04_06 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_04|2023_05|2023_06") %>%
rast() %>%
mean()
make_table <- function(roi_sf, unit_name){
roi_sf$ntl_2022       <- exact_extract(r_before,     roi_sf, "sum", progress = F)
roi_sf$ntl_2023_04_06 <- exact_extract(r_2023_04_06, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_07_09 <- exact_extract(r_2023_07_09, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_10_12 <- exact_extract(r_2023_10_12, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_01_03 <- exact_extract(r_2024_01_03, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_04_06 <- exact_extract(r_2024_04_06, roi_sf, "sum", progress = F)
roi_sf <- roi_sf %>%
dplyr::mutate(pc_2023_04_06 = (ntl_2023_04_06 - ntl_2022) / ntl_2022 * 100,
pc_2023_07_09 = (ntl_2023_07_09 - ntl_2022) / ntl_2022 * 100,
pc_2023_10_12 = (ntl_2023_10_12 - ntl_2022) / ntl_2022 * 100,
pc_2024_01_03 = (ntl_2024_01_03 - ntl_2022) / ntl_2022 * 100,
pc_2024_04_06 = (ntl_2024_04_06 - ntl_2022) / ntl_2022 * 100) %>%
st_drop_geometry() %>%
dplyr::filter(ntl_2022 > 0)
roi_sf$Name <- roi_sf[[unit_name]]
roi_sf %>%
dplyr::select(Name, ntl_2022, contains("pc_")) %>%
dplyr::mutate(across(c(ntl_2022, contains("pc_")), ~ round(.x, 2))) %>%
dplyr::rename("NTL: 2022" = ntl_2022,
"% Change: 2023 Q2"= pc_2023_04_06,
"% Change: 2023 Q3"= pc_2023_07_09,
"% Change: 2023 Q4"= pc_2023_10_12,
"% Change: 2024 Q1"= pc_2024_01_03,
"% Change: 2024 Q2"= pc_2024_04_06) %>%
DT::datatable()
}
roi_sf$ntl_2022       <- exact_extract(r_before,     roi_sf, "sum", progress = F)
roi_sf <- load_gadm(1)
roi_sf$ntl_2022       <- exact_extract(r_before,     roi_sf, "sum", progress = F)
roi_sf$ntl_2023_04_06 <- exact_extract(r_2023_04_06, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_04_06 <- exact_extract(r_2023_04_06, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_07_09 <- exact_extract(r_2023_07_09, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_07_09 <- exact_extract(r_2023_07_09, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_10_12 <- exact_extract(r_2023_10_12, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_01_03 <- exact_extract(r_2024_01_03, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_01_03 <- exact_extract(r_2024_01_03, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_04_06 <- exact_extract(r_2024_04_06, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_10_12 <- exact_extract(r_2023_10_12, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_01_03 <- exact_extract(r_2024_01_03, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_04_06 <- exact_extract(r_2024_04_06, roi_sf, "sum", progress = F)
roi_sf <- roi_sf %>%
dplyr::mutate(pc_2023_04_06 = (ntl_2023_04_06 - ntl_2022) / ntl_2022 * 100,
pc_2023_07_09 = (ntl_2023_07_09 - ntl_2022) / ntl_2022 * 100,
pc_2023_10_12 = (ntl_2023_10_12 - ntl_2022) / ntl_2022 * 100,
pc_2024_01_03 = (ntl_2024_01_03 - ntl_2022) / ntl_2022 * 100,
pc_2024_04_06 = (ntl_2024_04_06 - ntl_2022) / ntl_2022 * 100) %>%
st_drop_geometry() %>%
dplyr::filter(ntl_2022 > 0)
VieW(roi_sf)
View(roi_sf)
r_before <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2022") %>%
rast() %>%
mean()
r_before
#### Prep Rasters
r_before <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2022") %>%
rast() %>%
mean()
#### Prep Rasters
r_before <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2022") %>%
rast() %>%
mean()
r_2023_04_06 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_04|2023_05|2023_06") %>%
rast() %>%
mean()
r_2023_07_09 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_07|2023_08|2023_09") %>%
rast() %>%
mean()
r_2023_10_12 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_10|2023_11|2023_12") %>%
rast() %>%
mean()
r_2024_01_03 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_01|2023_02|2023_03") %>%
rast() %>%
mean()
r_2024_01_03 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_01|2023_02|2023_03") %>%
rast() %>%
mean()
r_2024_04_06 <- file.path(ntl_bm_dir, "rasters", "monthly") %>%
list.files(full.names = T) %>%
str_subset("2023_04|2023_05|2023_06") %>%
rast() %>%
mean()
roi_sf <- load_gadm(1)
roi_sf$ntl_2022       <- exact_extract(r_before,     roi_sf, "sum", progress = F)
roi_sf$ntl_2022       <- exact_extract(r_before,     roi_sf, "sum", progress = F)
roi_sf$ntl_2023_04_06 <- exact_extract(r_2023_04_06, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_07_09 <- exact_extract(r_2023_07_09, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_07_09 <- exact_extract(r_2023_07_09, roi_sf, "sum", progress = F)
roi_sf$ntl_2023_10_12 <- exact_extract(r_2023_10_12, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_01_03 <- exact_extract(r_2024_01_03, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_01_03 <- exact_extract(r_2024_01_03, roi_sf, "sum", progress = F)
roi_sf$ntl_2024_04_06 <- exact_extract(r_2024_04_06, roi_sf, "sum", progress = F)
roi_sf <- roi_sf %>%
dplyr::mutate(pc_2023_04_06 = (ntl_2023_04_06 - ntl_2022) / ntl_2022 * 100,
pc_2023_07_09 = (ntl_2023_07_09 - ntl_2022) / ntl_2022 * 100,
pc_2023_10_12 = (ntl_2023_10_12 - ntl_2022) / ntl_2022 * 100,
pc_2024_01_03 = (ntl_2024_01_03 - ntl_2022) / ntl_2022 * 100,
pc_2024_04_06 = (ntl_2024_04_06 - ntl_2022) / ntl_2022 * 100) %>%
st_drop_geometry() %>%
dplyr::filter(ntl_2022 > 0)
View(roi_sf)
#| fig-height: 10
ntl_df <- readRDS(file.path(ntl_bm_dir, "aggregated",
paste0("ntl_", "cities5km", "_", "annual", ".Rds")))
ntl_df %>%
dplyr::rename(city_name = name) %>%
dplyr::select(date, city_name, geoname_id, ntl_gf_10km_sum, ntl_nogf_10km_sum) %>%
pivot_longer(cols = -c(date, city_name, geoname_id)) %>%
dplyr::mutate(name = case_when(
name == "ntl_gf_10km_sum" ~ "NTL: Gas Flares",
name == "ntl_nogf_10km_sum" ~ "NTL: No Gas Flares"
)) %>%
dplyr::filter(geoname_id %in% top_adm) %>%
ggplot() +
geom_line(aes(x = date,
y = value,
color = name),
size = 1) +
labs(color = NULL,
x = NULL,
y = "NTL") +
facet_wrap(~name,
ncol = 3,
scales = "free_y") +
scale_color_manual(values = c(wbg_color_light,
wbg_color_dark)) +
theme_manual +
theme(legend.position = "top")
#| fig-height: 10
ntl_df <- readRDS(file.path(ntl_bm_dir, "aggregated",
paste0("ntl_", "cities5km", "_", "annual", ".Rds")))
ntl_df %>%
dplyr::rename(city_name = name) %>%
dplyr::select(date, city_name, geoname_id, ntl_gf_10km_sum, ntl_nogf_10km_sum) %>%
pivot_longer(cols = -c(date, city_name, geoname_id)) %>%
dplyr::mutate(name = case_when(
name == "ntl_gf_10km_sum" ~ "NTL: Gas Flares",
name == "ntl_nogf_10km_sum" ~ "NTL: No Gas Flares"
)) %>%
dplyr::filter(geoname_id %in% top_adm) %>%
ggplot() +
geom_line(aes(x = date,
y = value,
color = name),
size = 1) +
labs(color = NULL,
x = NULL,
y = "NTL") +
facet_wrap(~name,
ncol = 3,
scales = "free_y") +
scale_color_manual(values = c(wbg_color_light,
wbg_color_dark)) +
theme_manual +
theme(legend.position = "top")
#| fig-height: 10
ntl_df <- readRDS(file.path(ntl_bm_dir, "aggregated",
paste0("ntl_", "cities5km", "_", "annual", ".Rds")))
top_adm <- ntl_df %>%
dplyr::filter(name %in% c("Khartoum",
"Omdurman",
"Nyala",
"Port Sudan",
"Kassala",
"El Obeid",
"Al Qadarif",
"Kosti",
"Wad Medani",
"El Daein",
"El Fasher",
"Singa",
"Ad-Damazin",
"Geneina",
"Rabak")) %>%
pull(geoname_id)
#| fig-height: 10
ntl_df <- readRDS(file.path(ntl_bm_dir, "aggregated",
paste0("ntl_", "cities5km", "_", "annual", ".Rds")))
#| fig-height: 10
ntl_df <- readRDS(file.path(ntl_bm_dir, "aggregated",
paste0("ntl_", "cities5km", "_", "annual", ".Rds")))
ntl_df %>%
dplyr::rename(city_name = name) %>%
dplyr::select(date, city_name, geoname_id, ntl_gf_10km_sum, ntl_nogf_10km_sum) %>%
pivot_longer(cols = -c(date, city_name, geoname_id)) %>%
dplyr::mutate(name = case_when(
name == "ntl_gf_10km_sum" ~ "NTL: Gas Flares",
name == "ntl_nogf_10km_sum" ~ "NTL: No Gas Flares"
)) %>%
dplyr::filter(geoname_id %in% top_adm) %>%
ggplot() +
geom_line(aes(x = date,
y = value,
color = name),
size = 1) +
labs(color = NULL,
x = NULL,
y = "NTL") +
facet_wrap(~city_name,
ncol = 3,
scales = "free_y") +
scale_color_manual(values = c(wbg_color_light,
wbg_color_dark)) +
theme_manual +
theme(legend.position = "top")
